## Squeegee [tech.]

Provisioning nice and shiny Windows operating system environments has not always been a easy task. Now, with squeegee in your toolbox you can feel the spirit of Microsoft again.

Squeegee by itself does not do much. It glues together the properties of some supergood opensource projects. So what do we got here?

- Template-based creation of windows boxen ([Veewee](https://github.com/jedi4ever/veewee))
- Ruby-esque configuration of [VirtualBox](http://www.virtualbox.org/) boxen provider
- Unattended installation utilizing [Windows Assessment and Deployment Kit (ADK)](http://www.microsoft.com/en-us/download/details.aspx?id=30652)
- Full support of Windows Remote Management ([WinRM](https://msdn.microsoft.com/en-us/library/aa384426(v=vs.85).aspx))
- Integrated installation of [Opscode Chef](https://www.chef.io/) 12 ([for Windows](https://www.chef.io/solutions/windows/))
- [PowerShell]() 3, [CMD.EXE](http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/cmd.mspx) and [Cygwin](http://cygwin.com/) supported
- Repeatable, reboot resilient software package management using [Chocolatey](https://chocolatey.org/) packages ([Boxstarter](http://boxstarter.org/))

## Supported Source Platform

- Apple OS X ([Yosemite](https://en.wikipedia.org/wiki/OS_X_Yosemite))

## Supported Target Platform

- Microsoft Windows [Server 2012 R2](http://www.microsoft.com/en-us/server-cloud/products/windows-server-2012-r2/default.aspx)

## Installation

### Requirements

- Ruby 2
- Git
- [VirtualBox](http://www.virtualbox.org/)
- [Homebrew](http://brew.sh/) and [Homebrew Cask](http://caskroom.io/)

#### Homebrew

```
$ ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"

```

#### Homebrew Cask

```
$ brew install caskroom/cask/brew-cask

```

#### VirtualBox

```
$ brew update
$ brew cask install virtualbox
```

#### Bundler

Vanilla rubygems on OS X requires superuser priviliges to install gems, doh.
```
$ sudo gem install bundler
```

#### Clone and bundle

```
$ git clone --depth 1 https://github.com/gretel/squeegee.git
$ bundle
```

## Provisioning

### Session Configuration

Veewee is configured in Ruby at `vw/definitions/winbox/definition.rb`. Please see the [documentation](http://www.veewee.org/docs/vbox/) for in-depth information.

### Unattended Installation

The script generated by the ADK is at `vw/definitions/winbox/Autounattend.xml`. Please see and edit `ProductKey` and `SkipAutoActivation` to automagically activate your copies of Windows. Additional configuration keys of interest are:

```
AdministratorPassword
ComputerName
FullName
Organization
TimeZone
```

### Build and run boxen

```
$ bundle exec veewee vbox build winbox
```
If you want to overwrite a previous build do

```
$ bundle exec veewee vbox build winbox --force
```

Please wait a bit until the VirtualBox window comes up.

## Management

TODO

## Bootstrap cookbook

TODO

### SC-win-run

Include `SC-win-run` in your node's `run_list`:

```json
{
  "run_list": [
    "recipe[SC-win-run]"
  ]
}
```

## License and Authors

Author:: Tom Hensel (adobe@jitter.eu (tom87213@adobe.com))
